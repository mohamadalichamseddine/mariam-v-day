<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>To Mariam,</title>
    <!-- Google Fonts for a playful look -->
    <link href="https://fonts.googleapis.com/css2?family=Sacramento&family=Nunito:wght@400;700&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="styles/styles.css" />
    <!-- Include canvas-confetti for confetti animation -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        /* Bounce animation for the Yes button */
        @keyframes bounce {
            0% {
                transform: scale(1);
            }

            30% {
                transform: scale(1.2);
            }

            50% {
                transform: scale(0.9);
            }

            70% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .btn.clicked {
            animation: bounce 0.5s ease;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1 class="header_text">To Mariam,</h1>
        <h1 class="header_text question_text">Will you be my valentine?</h1>
        <div class="image_container">
            <!-- Replace with your selected romantic photo -->
            <img src="assets/images/romantic-photo.jpg" alt="Romantic Background">
        </div>
        <div class="buttons">
            <button class="btn" id="yesButton" onclick="goToYesPage()">Yes!</button>
            <button class="btn" id="noButton" onmouseover="evadeButton()" onclick="evadeButton()">No</button>
        </div>
    </div>

    <!-- GIF container (initially hidden) -->
    <img id="randomGif"
        style="opacity: 0.8; display: none; position: fixed; top: 20%; left: 84%; transform: translate(-50%, -50%); max-width: 300px; border: 2px solid #fff; border-radius: 10px; z-index: 1000;"
        alt="Random Gif" />

    <script>
        // Prevent overlapping GIFs
        let gifActive = false;

        // Array of GIF URLs
        const gifUrls = [
            "assets/gifs/gif_1.gif",
            "assets/gifs/gif_2.gif",
            "assets/gifs/gif_3.gif",
            "assets/gifs/gif_4.gif",
            "assets/gifs/gif_5.gif"
        ];

        // Timing controls
        const GIF_VISIBLE_MS = 1700;
        const GIF_FADE_MS = 200;

        // Shuffle helper (Fisher-Yates)
        function shuffleArray(arr) {
            const a = [...arr];
            for (let i = a.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [a[i], a[j]] = [a[j], a[i]];
            }
            return a;
        }

        // Start with a shuffled queue
        let gifQueue = shuffleArray(gifUrls);
        let currentGifIndex = 0;

        // Get next GIF in sequence; reshuffle after a full cycle
        function getNextGif() {
            const gif = gifQueue[currentGifIndex];
            currentGifIndex++;

            if (currentGifIndex >= gifQueue.length) {
                gifQueue = shuffleArray(gifUrls); // reshuffle for next cycle
                currentGifIndex = 0;
            }

            return gif;
        }

        // Function to move the "No" button and show the next GIF
        function evadeButton() {
            const noBtn = document.getElementById("noButton");
            const btnWidth = noBtn.offsetWidth;
            const btnHeight = noBtn.offsetHeight;
            const maxX = window.innerWidth - btnWidth;

            // Avoid the top region where the GIF is displayed
            const minY = window.innerHeight * 0.3;
            const maxY = window.innerHeight - btnHeight;

            const randomX = Math.random() * maxX;
            const randomY = Math.random() * (maxY - minY) + minY;

            noBtn.style.position = "absolute";
            noBtn.style.left = randomX + "px";
            noBtn.style.top = randomY + "px";

            // Check if a GIF is already active; if so, exit
            const gifDisplay = document.getElementById("randomGif");
            if (gifActive) return;
            gifActive = true;

            // Pick and display next GIF in shuffled sequence
            const selectedGif = getNextGif();
            gifDisplay.src = selectedGif;
            gifDisplay.style.display = "block";
            gifDisplay.style.opacity = 0;
            gifDisplay.style.transition = `opacity ${GIF_FADE_MS}ms`;

            // Fade in
            setTimeout(() => {
                gifDisplay.style.opacity = 1;
            }, 25);

            // Keep visible, then fade out
            setTimeout(() => {
                gifDisplay.style.opacity = 0;
                setTimeout(() => {
                    gifDisplay.style.display = "none";
                    gifActive = false;
                }, GIF_FADE_MS);
            }, GIF_VISIBLE_MS);
        }

        // Function to animate the Yes button and navigate to the next page
        function goToYesPage() {
            const yesBtn = document.getElementById("yesButton");
            yesBtn.classList.add("clicked");

            // Trigger confetti explosion
            confetti({
                particleCount: 150,
                spread: 70,
                origin: { y: 0.6 }
            });

            // Wait for animation and confetti effect before redirecting
            setTimeout(() => {
                window.location.href = "yes.html";
            }, 1400);
        }
    </script>
</body>

</html>
